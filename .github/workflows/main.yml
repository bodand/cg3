on: [push]
name: Default action

jobs:
  job:
    name: ${{ matrix.os }}-${{ github.workflow }}
    runs-on: ${{ matrix.os }}
    strategy:
      fail-fast: false
      matrix:
        os: 
          - ubuntu-latest
#           - macos-latest
          - windows-latest
        include:
          - os: windows-latest
            triplet: x64-windows
            conf_preset: win-msvc-x64-rel
            build_preset: rel-full-rebuild-win-msvc
          - os: ubuntu-latest
            triplet: x64-linux
            conf_preset: lnx-gcc-x64-rel
            build_preset: rel-full-rebuild-lnx-gcc
#           - os: macos-latest
#             triplet: x64-osx
#             conf_preset: osx-gcc-x64-rel
#             build_preset: rel-full-rebuild-osx-gcc
            
    env:
      VCPKG_DEFAULT_TRIPLET: ${{ matrix.triplet }}
  
    steps:
      - name: Checkout w/ submodules
        uses: actions/checkout@v3
        with:
          submodules: true
      - name: Get CMake
        uses: lukka/get-cmake@latest
      - name: Setup vcpkg
        uses: lukka/run-vcpkg@v10
        id: runvcpkg
      - name: Perform build
        uses: lukka/run-cmake@v10
        with:
          configurePreset: ${{ matrix.conf_preset }}
          buildPreset: ${{ matrix.build_preset }}
